<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRAGNDROP</title>
</head>
<style>
    img {
        max-width: 100px;

    }

    .img {}

    .container {}
</style>

<body>
    <div class="container" id="container">

        <img src="/home/Drag/86103857_w640_h640_optom-antistress-futbolnyj.jpg" alt="">
        <img src="/home/Drag/86103857_w640_h640_optom-antistress-futbolnyj.jpg" alt="">
        <img src="/home/Drag/86103857_w640_h640_optom-antistress-futbolnyj.jpg" alt="">
        <img src="/home/Drag/86103857_w640_h640_optom-antistress-futbolnyj.jpg" alt="">
        <img src="/home/Drag/86103857_w640_h640_optom-antistress-futbolnyj.jpg" alt="">
    </div>
    <button onclick="addImg()">addImg</button>
    <script>
        const container = document.getElementById('container');

        let imgArr = container.querySelectorAll('img');
        console.log(imgArr);
        function addImg() {
            let imgAr = container.querySelectorAll('img');
            let imgadd = document.createElement('img')
            imgadd.setAttribute("src", "/home/Drag/86103857_w640_h640_optom-antistress-futbolnyj.jpg")
            imgadd.setAttribute("id", imgAr.length);
            container.appendChild(imgadd)
        }
        imgArr.forEach(f)
        function f(elem, i, arr) {
            arr[i].setAttribute("id", i)
        };

        container.addEventListener("mousedown", DD)
            function DD(ev){
            let ball = ev.target;
            if(ball==ev.currentTarget){
                return
            }
            let posBalltarg = ball.getBoundingClientRect();
            let posX = Math.round(ev.clientX - posBalltarg.x);
            let posY = Math.round(ev.clientY - posBalltarg.y);
            let posContX=ball.offsetLeft;
            let posContY=ball.offsetTop;
            console.log(posContX);
           console.log(posX,posY);
            document.addEventListener('mousemove', onMouseMove);
            function onMouseMove(ev){
                
                 ball.style.position = 'relative';
                ball.style.left=ev.pageX-posX-posContX+"px"
                ball.style.top=ev.pageY-posY-posContY+"px" 
            }
            document.addEventListener('mouseup',onMouseDrop)
           function onMouseDrop(ev){
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('mouseup',onMouseDrop);
            
           }
            
        }

    </script>
</body>

</html>