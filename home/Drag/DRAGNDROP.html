<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRAGNDROP</title>
</head>
<style>
    img {
        max-width: 100px;

    }

    .img {}

    .container {}
</style>

<body>
    <div class="container" id="container">

        <img src="ff.jpg" alt="">
        <img src="ff.jpg" alt="">
        <img src="ff.jpg" alt="">
        <img src="ff.jpg" alt="">
        <img src="ff.jpg" alt="">
    </div>
    <button onclick="addImg()">addImg</button>
    <script>
        const container = document.getElementById('container');

        let imgArr = container.querySelectorAll('img');
        console.log(imgArr);
        function addImg() {
            let imgAr = container.querySelectorAll('img');
            let imgadd = document.createElement('img')
            imgadd.setAttribute("src", "ff.jpg")
            imgadd.setAttribute("id", imgAr.length);
            container.appendChild(imgadd)
        }
        imgArr.forEach(f)
        function f(elem, i, arr) {
            arr[i].setAttribute("id", i)
        };

        container.addEventListener("mousedown", DD)
            function DD(ev){
            let ball = ev.target;
            if(ball==ev.currentTarget){
                return
            }
            let posBalltarg = ball.getBoundingClientRect();
            let posX = Math.round(ev.clientX - posBalltarg.x);
            let posY = Math.round(ev.clientY - posBalltarg.y);
            let posContX=ball.offsetLeft;
            let posContY=ball.offsetTop;

            document.addEventListener('mousemove', onMouseMove);
            function onMouseMove(ev){
                
                 ball.style.position = 'relative';
                ball.style.left=ev.pageX-posX-posContX+"px"
                ball.style.top=ev.pageY-posY-posContY+"px" 
            }
            ball.addEventListener('mouseup',onMouseDrop)
           function onMouseDrop(ev){
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('mouseup',onMouseDrop); }
            ball.ondragstart = function() {
  return false;
};
          
            
        } 
        /* let ball=document.getElementById("2")
        ball.onmousedown = function(event) {

let shiftX = event.clientX - ball.getBoundingClientRect().left;
let shiftY = event.clientY - ball.getBoundingClientRect().top;

ball.style.position = 'absolute';
ball.style.zIndex = 1000;
document.body.append(ball);

moveAt(event.pageX, event.pageY);

// переносит мяч на координаты (pageX, pageY),
// дополнительно учитывая изначальный сдвиг относительно указателя мыши
function moveAt(pageX, pageY) {
  ball.style.left = pageX - shiftX + 'px';
  ball.style.top = pageY - shiftY + 'px';
}

function onMouseMove(event) {
  moveAt(event.pageX, event.pageY);
}

// передвигаем мяч при событии mousemove
document.addEventListener('mousemove', onMouseMove);

// отпустить мяч, удалить ненужные обработчики
ball.onmouseup = function() {
  document.removeEventListener('mousemove', onMouseMove);
  ball.onmouseup = null;
};

};

ball.ondragstart = function() {
return false;
}; */
    </script>
</body>

</html>